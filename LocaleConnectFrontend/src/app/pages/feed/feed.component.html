<div class="locale-connect">
  <aside class="profile-sidebar">
    <div class="profile-header">
      <button mat-icon-button class="profile-image-upload" (click)="imageInput.click()">
        <img [src]="profileImageSrc" alt="Profile Image" class="profile-image">
      </button>
      <input type="file" #imageInput (change)="changeProfilePicture($event)" style="display: none;" accept="image/*">
      <h2 class="profile-name">John Doe</h2>
      <p class="profile-handle">@johndoe</p>
    </div>
    <nav class="profile-nav">
      <button mat-raised-button class="make-post" (click)="openAddPostDialog()">Add a Post</button>

    </nav>
  </aside>

  <div class="feed-wrapper">
    <mat-card class="post-card" *ngFor="let post of posts">
      <mat-card-header>
        <div class="post-header">
          <div class="author-details">
            <img [src]="profileImageSrc" alt="Profile Image" class="profile-image">
            <div class="details-section">
            <mat-card-title>{{ post.authorID }}</mat-card-title>
            <mat-card-subtitle>{{ post.date | date: 'medium' }}</mat-card-subtitle>
            </div>
          </div>
          <button mat-button class="follow-btn" (click)="toggleFollow(post)">
            {{ post.isFollowingAuthor ? 'Unfollow' : 'Follow' }}
          </button>
        </div>
      </mat-card-header>
      <mat-card-content>
        <div class="post-content">
            <ng-container *ngFor="let image of post.images; let i = index">
              <ng-container *ngIf="showAllImages || i < 3">
                <img mat-card-image [src]="image" alt="Post image">
              </ng-container>
            </ng-container>
            <button *ngIf="post.images.length > 3" (click)="toggleImagesDisplay()">
              {{showAllImages ?  '- less' : '+'+(post.images.length-3)+' more'}}
            </button>
        <p>{{ post.content }}</p>
        </div>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button (click)="likePost(post)">
          <mat-icon [class.liked]="post.likedByUser">thumb_up</mat-icon>
          <span>{{ post.likes || null }}</span>
        </button>
      </mat-card-actions>
      <mat-card-footer>
        <div *ngIf="post.comments.length">
          <div class="comment" *ngFor="let comment of post.comments">
            <span class="comment-author">{{ comment.authorID }}</span>
            <span class="comment-date">{{ comment.date | date: 'short' }}</span>
            <p class="comment-text">{{ comment.text }}</p>
          </div>
        </div>
        <div class="add-comment-section">
          <mat-form-field class="comment-input">
            <input matInput placeholder="Write a comment..."
                   [(ngModel)]="newCommentTexts[post.id]"
                   (keyup.enter)="addComment(post.id)">
          </mat-form-field>
          <button mat-icon-button (click)="addComment(post.id)">
            <mat-icon>send</mat-icon>
          </button>
        </div>
      </mat-card-footer>
    </mat-card>
  </div>
  <aside class="followers-sidebar">
    <h3 class="sidebar-title">Followers</h3>
    <mat-list>
      <mat-list-item *ngFor="let follower of followers" >
        <div class="follower-item">
        <div class="avatar">
          <mat-icon>account_circle</mat-icon>
        </div>
        <div class="follower-details">
          <h4 class="follower-name">{{ follower.name }}</h4>
          <p class="follower-handle">{{ follower.handle }}</p>
        </div>
        </div>
      </mat-list-item>
    </mat-list>
  </aside>

</div>
