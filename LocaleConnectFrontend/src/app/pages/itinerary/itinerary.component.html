<div class="filters-and-search-container">
  <div class="search-container">
    <input matInput [formControl]="searchControl" placeholder="Search itineraries by title" class="search-bar"/>
    <button mat-icon-button class="search-button" (click)="performSearch()">
      <mat-icon>search</mat-icon>
    </button>
  </div>
  <div class="filter-container" [formGroup]="filterForm" >
    <input matInput formControlName="place" placeholder="Place">
    <input matInput  formControlName="days" placeholder="Maximum Days">
    <div class="selector">
    <mat-select formControlName="tag" placeholder="Tag" >
      <mat-option *ngFor="let tag of tagOptions" [value]="tag">{{ tag }}</mat-option>
    </mat-select>
    </div>

    <button mat-button (click)="performFilter()">Apply Filters</button>
  </div>
</div>


<ng-container class="main-container" *ngFor="let itinerary of allItineraries">
  <mat-card class="itinerary-card">
    <div class="card-content">
      <div class="image-container">
        <img *ngIf="itinerary.imageUrls.length > 0; else fallbackImage" [src]="itinerary.imageUrls[0]"
             alt="Itinerary image">
        <ng-template #fallbackImage>
          <img src="assets/pictures/not_available.png" alt="Default itinerary image">
        </ng-template>
      </div>

      <div class="details-container">
        <mat-card-header>
          <mat-card-title>{{ itinerary.name }}</mat-card-title>
          <mat-card-subtitle>Organized by: {{ itinerary.username }}</mat-card-subtitle>
          <div class="reviews-container">
            <app-review [(rating)]="itinerary.rating" (ratingChange)="submitRating(itinerary.id, $event)"></app-review>
          </div>
        </mat-card-header>

        <mat-card-content *ngIf="itinerary.expand" class="itinerary-details">
          <p>{{ itinerary.description }}</p>
          <div *ngIf="itinerary.tags.length">
            <mat-chip-listbox>
              <mat-chip class="tag" *ngFor="let tag of itinerary.mappedTags">{{ tag }}</mat-chip>
            </mat-chip-listbox>
          </div>
          <div *ngIf="itinerary.numberOfDays">
            <h4>Duration:</h4>
            <p>{{ itinerary.numberOfDays }}  Days</p>
          </div>

          <div *ngIf="itinerary.placesToVisit.length">
            <h4>Places to Visit:</h4>
            <ul>
              <li *ngFor="let place of itinerary.placesToVisit">{{ place }}</li>
            </ul>
          </div>
          <div *ngIf="itinerary.dailyActivities.length">
            <h4>Activities:</h4>
            <ul>
              <li *ngFor="let activity of itinerary.dailyActivities">{{ activity }}</li>
            </ul>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button (click)="toggleDetails(itinerary)">
            {{ itinerary.expand ? 'Hide Details' : 'View Details' }}
          </button>
        </mat-card-actions>
      </div>
    </div>
  </mat-card>
</ng-container>
<div class="button-container">
  <button mat-raised-button (click)="openAddItineraryDialog()">Add Itinerary</button>
</div>


